{
  "version": 3,
  "sources": ["main.ts"],
  "sourcesContent": ["import {\r\n  App,\r\n  Editor,\r\n  MarkdownRenderer,\r\n  Notice,\r\n  Plugin,\r\n  PluginSettingTab,\r\n  Setting\r\n} from \"obsidian\";\r\n\r\ntype AIWHSettings = {\r\n  openrouterApiKey: string;\r\n  modelDictionary: string;\r\n  modelCorrection: string;\r\n  modelExplanation: string;\r\n};\r\n\r\nconst DEFAULT_SETTINGS: AIWHSettings = {\r\n  openrouterApiKey: \"\",\r\n  modelDictionary: \"google/gemini-2.5-flash-lite-002\",\r\n  modelCorrection: \"google/gemini-2.5-flash-lite-002\",\r\n  modelExplanation: \"google/gemini-2.5-flash-lite-002\"\r\n};\r\n\r\nenum TaskKind {\r\n  Dictionary = \"Dictionary\",\r\n  Correction = \"Correction\",\r\n  Explanation = \"Explanation\",\r\n}\r\n\r\nexport default class AIWritingHelper extends Plugin {\r\n  settings: AIWHSettings;\r\n\r\n  async onload() {\r\n    await this.loadSettings();\r\n\r\n    // Commands (also useful for hotkeys)\r\n    this.addCommand({\r\n      id: \"aiwh-dictionary\",\r\n      name: \"Define\",\r\n      editorCallback: (editor) => this.runTask(TaskKind.Dictionary, editor),\r\n    });\r\n    this.addCommand({\r\n      id: \"aiwh-correction\",\r\n      name: \"Correct\",\r\n      editorCallback: (editor) => this.runTask(TaskKind.Correction, editor),\r\n    });\r\n    this.addCommand({\r\n      id: \"aiwh-explain\",\r\n      name: \"Explain\",\r\n      editorCallback: (editor) => this.runTask(TaskKind.Explanation, editor),\r\n    });\r\n\r\n    // Context (right-click) editor menu\r\n    this.registerEvent(\r\n      this.app.workspace.on(\"editor-menu\", (menu, editor /* , view */) => {\r\n        const hasSelection = !!editor.getSelection();\r\n        if (!hasSelection) return;\r\n\r\n        menu.addItem((item) =>\r\n          item\r\n            .setTitle(\"Define\")\r\n            .setIcon(\"book\")\r\n            .onClick(() => this.runTask(TaskKind.Dictionary, editor))\r\n        );\r\n        menu.addItem((item) =>\r\n          item\r\n            .setTitle(\"Correct\")\r\n            .setIcon(\"check\")\r\n            .onClick(() => this.runTask(TaskKind.Correction, editor))\r\n        );\r\n        menu.addItem((item) =>\r\n          item\r\n            .setTitle(\"Explain\")\r\n            .setIcon(\"help-circle\")\r\n            .onClick(() => this.runTask(TaskKind.Explanation, editor))\r\n        );\r\n      })\r\n    );\r\n\r\n    // Settings UI\r\n    this.addSettingTab(new AIWHSettingTab(this.app, this));\r\n\r\n    console.log(\"AI Writing Helper loaded\");\r\n  }\r\n\r\n  onunload() {\r\n    console.log(\"AI Writing Helper unloaded\");\r\n  }\r\n\r\n  async runTask(kind: TaskKind, editor: Editor) {\r\n    const selection = editor.getSelection().trim();\r\n    if (!selection) {\r\n      new Notice(\"Select some text first.\");\r\n      return;\r\n    }\r\n    if (!this.settings.openrouterApiKey) {\r\n      new Notice(\"Set your OpenRouter API key in settings.\");\r\n      return;\r\n    }\r\n\r\n    const doc = editor.getValue();\r\n    // Grab some context around the selection (bounded)\r\n    const cursorFrom = editor.getCursor(\"from\");\r\n    const cursorTo = editor.getCursor(\"to\");\r\n    const fromPos = editor.posToOffset(cursorFrom);\r\n    const toPos = editor.posToOffset(cursorTo);\r\n\r\n    const LEFT = Math.max(0, fromPos - 40);\r\n    const RIGHT = Math.min(doc.length, toPos + 40);\r\n    const leftCtx = doc.slice(LEFT, fromPos);\r\n    const rightCtx = doc.slice(toPos, RIGHT);\r\n    const surrounding = `${leftCtx}[${selection}]${rightCtx}`;\r\n\r\n    this.showPopoverAtSelection(\"Working\u2026\");\r\n\r\n    try {\r\n      const model = this.getModelFor(kind);\r\n      const prompt = buildPrompt(kind, selection, leftCtx, rightCtx, doc);\r\n      const md = await callOpenRouterChat({\r\n        apiKey: this.settings.openrouterApiKey,\r\n        model,\r\n        system: SYSTEM_PROMPT,\r\n        user: prompt,\r\n      });\r\n\r\n      await this.updatePopoverMarkdown(md);\r\n    } catch (e: any) {\r\n      const msg = String(e?.message || e);\r\n      await this.updatePopoverMarkdown(\r\n        `**Error**\\n\\n\\`\\`\\`\\n${msg}\\n\\`\\`\\`\\n\\nCheck API key, model name, or rate limits.`\r\n      );\r\n    }\r\n  }\r\n\r\n  getModelFor(kind: TaskKind): string {\r\n    switch (kind) {\r\n      case TaskKind.Dictionary:\r\n        return this.settings.modelDictionary || DEFAULT_SETTINGS.modelDictionary;\r\n      case TaskKind.Correction:\r\n        return this.settings.modelCorrection || DEFAULT_SETTINGS.modelCorrection;\r\n      case TaskKind.Explanation:\r\n        return this.settings.modelExplanation || DEFAULT_SETTINGS.modelExplanation;\r\n    }\r\n  }\r\n\r\n  // --- Popup UI ---\r\n\r\n  popoverEl: HTMLElement | null = null;\r\n  contentEl: HTMLElement | null = null;\r\n\r\n  showPopoverAtSelection(initialMarkdown: string) {\r\n    this.destroyPopover();\r\n\r\n    const rect = getSelectionRect();\r\n    const container = createDiv({ cls: \"aiwh-popover\" });\r\n    const header = container.createDiv({ cls: \"aiwh-header\" });\r\n    header.setText(\"AI Writing Helper\");\r\n\r\n    const content = container.createDiv();\r\n    this.popoverEl = container;\r\n    this.contentEl = content;\r\n\r\n    // Actions\r\n    const actions = container.createDiv({ cls: \"aiwh-actions\" });\r\n    const copyBtn = createEl(\"button\", { text: \"Copy\" });\r\n    const closeBtn = createEl(\"button\", { text: \"Close\" });\r\n    actions.appendChild(copyBtn);\r\n    actions.appendChild(closeBtn);\r\n\r\n    copyBtn.addEventListener(\"click\", async () => {\r\n      if (!content) return;\r\n      // Copy raw markdown (source text)\r\n      const raw = content.getAttribute(\"data-raw-markdown\") || content.textContent || \"\";\r\n      await navigator.clipboard.writeText(raw);\r\n      new Notice(\"Copied\");\r\n    });\r\n\r\n    closeBtn.addEventListener(\"click\", () => this.destroyPopover());\r\n\r\n    // Position below selection, clamp within viewport\r\n    const margin = 6;\r\n    const top = Math.min(\r\n      window.innerHeight - 20,\r\n      (rect?.bottom ?? 80) + margin\r\n    );\r\n    const left = Math.min(\r\n      window.innerWidth - 560,\r\n      Math.max(8, (rect?.left ?? 80))\r\n    );\r\n    container.style.top = `${top}px`;\r\n    container.style.left = `${left}px`;\r\n\r\n    document.body.appendChild(container);\r\n    // Initial render\r\n    this.updatePopoverMarkdown(initialMarkdown);\r\n    // Destroy on Escape\r\n    const esc = (ev: KeyboardEvent) => {\r\n      if (ev.key === \"Escape\") this.destroyPopover();\r\n    };\r\n    window.addEventListener(\"keydown\", esc, { once: true });\r\n    const outsideClick = (ev: MouseEvent) => {\r\n        if (!container.contains(ev.target as Node)) {\r\n            this.destroyPopover();\r\n            document.removeEventListener(\"mousedown\", outsideClick);\r\n        }\r\n    };\r\n    setTimeout(() => {\r\n        document.addEventListener(\"mousedown\", outsideClick);\r\n    }, 0);\r\n  }\r\n\r\n  async updatePopoverMarkdown(markdown: string) {\r\n    if (!this.popoverEl || !this.contentEl) return;\r\n    this.contentEl.empty();\r\n    this.contentEl.setAttribute(\"data-raw-markdown\", markdown);\r\n    await MarkdownRenderer.renderMarkdown(\r\n      markdown,\r\n      this.contentEl,\r\n      \"\",\r\n      this\r\n    );\r\n  }\r\n\r\n  destroyPopover() {\r\n    if (this.popoverEl) {\r\n      this.popoverEl.remove();\r\n      this.popoverEl = null;\r\n      this.contentEl = null;\r\n    }\r\n  }\r\n\r\n  async loadSettings() {\r\n    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());\r\n  }\r\n\r\n  async saveSettings() {\r\n    await this.saveData(this.settings);\r\n  }\r\n}\r\n\r\n// --- Settings tab ---\r\n\r\nclass AIWHSettingTab extends PluginSettingTab {\r\n  plugin: AIWritingHelper;\r\n\r\n  constructor(app: App, plugin: AIWritingHelper) {\r\n    super(app, plugin);\r\n    this.plugin = plugin;\r\n  }\r\n\r\n  display(): void {\r\n    const { containerEl } = this;\r\n    containerEl.empty();\r\n\r\n    containerEl.createEl(\"h2\", { text: \"AI Writing Helper \u2013 Settings\" });\r\n\r\n    new Setting(containerEl)\r\n      .setName(\"OpenRouter API Key\")\r\n      .setDesc(\"Stored locally in this vault.\")\r\n      .addText((text) =>\r\n        text\r\n          .setPlaceholder(\"sk-or-v1-...\")\r\n          .setValue(this.plugin.settings.openrouterApiKey)\r\n          .onChange(async (value) => {\r\n            this.plugin.settings.openrouterApiKey = value.trim();\r\n            await this.plugin.saveSettings();\r\n          })\r\n      );\r\n\r\n    new Setting(containerEl)\r\n      .setName(\"Model: Dictionary\")\r\n      .setDesc(\"Default: google/gemini-2.5-flash-lite\")\r\n      .addText((text) =>\r\n        text\r\n          .setPlaceholder(DEFAULT_SETTINGS.modelDictionary)\r\n          .setValue(this.plugin.settings.modelDictionary)\r\n          .onChange(async (value) => {\r\n            this.plugin.settings.modelDictionary = value.trim();\r\n            await this.plugin.saveSettings();\r\n          })\r\n      );\r\n\r\n    new Setting(containerEl)\r\n      .setName(\"Model: Correction\")\r\n      .setDesc(\"Default: google/gemini-2.5-flash-lite\")\r\n      .addText((text) =>\r\n        text\r\n          .setPlaceholder(DEFAULT_SETTINGS.modelCorrection)\r\n          .setValue(this.plugin.settings.modelCorrection)\r\n          .onChange(async (value) => {\r\n            this.plugin.settings.modelCorrection = value.trim();\r\n            await this.plugin.saveSettings();\r\n          })\r\n      );\r\n\r\n    new Setting(containerEl)\r\n      .setName(\"Model: Explanation\")\r\n      .setDesc(\"Default: google/gemini-2.5-flash-lite\")\r\n      .addText((text) =>\r\n        text\r\n          .setPlaceholder(DEFAULT_SETTINGS.modelExplanation)\r\n          .setValue(this.plugin.settings.modelExplanation)\r\n          .onChange(async (value) => {\r\n            this.plugin.settings.modelExplanation = value.trim();\r\n            await this.plugin.saveSettings();\r\n          })\r\n      );\r\n  }\r\n}\r\n\r\n// --- Helpers & API ---\r\n\r\nconst SYSTEM_PROMPT = `You are a precise, concise English assistant for an Obsidian plugin.\r\nWrite Markdown. Never use HTML. Prefer short, tidy outputs.`;\r\n\r\nfunction trimForTokens(s: string, maxChars: number) {\r\n  if (s.length <= maxChars) return s;\r\n  const half = Math.floor(maxChars / 2);\r\n  return s.slice(0, half) + \"\\n\u2026\\n\" + s.slice(s.length - half);\r\n}\r\n\r\nfunction buildPrompt(\r\n  kind: TaskKind,\r\n  selection: string,\r\n  leftCtx: string,\r\n  rightCtx: string,\r\n  fullDoc: string\r\n): string {\r\n  const L = trimForTokens(leftCtx, 50);\r\n  const R = trimForTokens(rightCtx, 50);\r\n  const DOC = trimForTokens(fullDoc, 2000);\r\n\r\n  if (kind === TaskKind.Dictionary) {\r\n    // Use your desired format for the dictionary (Markdown-safe)\r\n    return [\r\n      `Task: Define the selected text as a context-aware dictionary entry.`,\r\n      `Selection:\\n\"\"\"${selection}\"\"\"`,\r\n      `Left context:\\n\"\"\"${L}\"\"\"`,\r\n      `Right context:\\n\"\"\"${R}\"\"\"`,\r\n      `Output strictly in this Markdown format (1-line fields):`,\r\n      `***[Word(s)]*** (v./n./etc.) [Phonetic alphabet pronunciation American US English] ([English alphabet pronunciation help American US English])`,\r\n      `***Definition:*** [1-line definition]`,\r\n      `***Synonyms:*** [Up to 3 synonyms, separated by commas]`,\r\n      `***Etymology:*** [1-line explanation of etymology]`,\r\n      `If POS/pronunciation are unclear, make your best brief guess (or use \u201C\u2014\u201D).`\r\n    ].join(\"\\n\\n\");\r\n  }\r\n\r\n  if (kind === TaskKind.Correction) {\r\n    return [\r\n      `Task: Check whether the selection is correct English. Provide only a corrected version (non-destructive) and a 1-2 bullet rationale. If it's already correct and high quality, just say \"Correct.\".`,\r\n      `Selection:\\n\"\"\"${selection}\"\"\"`,\r\n      `Left context:\\n\"\"\"${L}\"\"\"`,\r\n      `Right context:\\n\"\"\"${R}\"\"\"`,\r\n      `Output Markdown like:\\n`,\r\n      `**Corrected:** <single best corrected version>`,\r\n      `- Reason 1`,\r\n      `- Reason 2 (optional)`,\r\n      `Do not rewrite more than necessary. Keep tone and meaning.`,\r\n    ].join(\"\\n\\n\");\r\n  }\r\n\r\n  // Explanation\r\n  return [\r\n    `Task: Explain the meaning of the selected text in the context of this document. Keep it concise and actionable.`,\r\n    `Selection:\\n\"\"\"${selection}\"\"\"`,\r\n    `Left context:\\n\"\"\"${L}\"\"\"`,\r\n    `Right context:\\n\"\"\"${R}\"\"\"`,\r\n    `Document context (truncated):\\n\"\"\"${DOC}\"\"\"`,\r\n    `Output Markdown with short sections:\\n`,\r\n    `**What it means**: <1\u20132 sentences>`,\r\n    `**Why it\u2019s written this way**: <1\u20132 bullets>`,\r\n    `**Possible alternatives**: <up to 3 short options in bullets>`,\r\n  ].join(\"\\n\\n\");\r\n}\r\n\r\nasync function callOpenRouterChat(opts: {\r\n  apiKey: string;\r\n  model: string;\r\n  system: string;\r\n  user: string;\r\n}): Promise<string> {\r\n  const body = {\r\n    model: opts.model,\r\n    messages: [\r\n      { role: \"system\", content: opts.system },\r\n      { role: \"user\", content: opts.user }\r\n    ],\r\n    temperature: 0.2,\r\n    max_tokens: 600\r\n  };\r\n\r\n  const res = await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Authorization\": `Bearer ${opts.apiKey}`,\r\n      // Optional headers improve routing at OpenRouter; harmless if not set:\r\n      \"HTTP-Referer\": \"obsidian://ai-writing-helper\",\r\n      \"X-Title\": \"AI Writing Helper for Obsidian\"\r\n    },\r\n    body: JSON.stringify(body)\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const txt = await res.text();\r\n    throw new Error(`OpenRouter error ${res.status}: ${txt}`);\r\n  }\r\n  const json = await res.json();\r\n  const content: string =\r\n    json?.choices?.[0]?.message?.content?.trim?.() ?? \"\";\r\n  if (!content) throw new Error(\"Empty completion.\");\r\n  return content;\r\n}\r\n\r\nfunction getSelectionRect(): DOMRect | null {\r\n  const sel = window.getSelection();\r\n  if (!sel || sel.rangeCount === 0) return null;\r\n  const range = sel.getRangeAt(0);\r\n  const rects = range.getClientRects();\r\n  if (rects.length > 0) return rects[rects.length - 1];\r\n  const rect = range.getBoundingClientRect();\r\n  return rect ?? null;\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
